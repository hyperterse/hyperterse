---
title: OpenAPI
description: Generate and use OpenAPI specifications for your queries.
---

import Aside from '@/components/admonition.astro'

Hyperterse automatically generates OpenAPI 3.0 specifications from your query definitions. This enables integration with API clients, testing tools, and documentation platforms.

## Accessing OpenAPI specs

### Runtime endpoint

The OpenAPI specification is available at `/docs`:

```bash
curl http://localhost:8080/docs
```

This returns a complete OpenAPI 3.0 JSON specification.

### View in browser

Open `http://localhost:8080/docs` in your browser to see the raw specification, or use a tool like Swagger UI.

## Generated specification

For each query, Hyperterse generates:

- **Path**: `/query/{query-name}`
- **Method**: `POST`
- **Request Schema**: Based on input definitions
- **Response Schema**: Based on data definitions
- **Description**: From query description

### Example

Given this query:

```yaml
queries:
  get-user-by-id:
    use: main_db
    description: 'Retrieve a user by their unique ID'
    statement: 'SELECT id, name, email FROM users WHERE id = {{ inputs.userId }}'
    inputs:
      userId:
        type: int
        description: 'Unique user identifier'
```

Hyperterse generates:

```json
{
  "openapi": "3.0.0",
  "info": {
    "title": "Hyperterse API",
    "version": "1.0.0"
  },
  "paths": {
    "/query/get-user-by-id": {
      "post": {
        "summary": "Retrieve a user by their unique ID",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["userId"],
                "properties": {
                  "userId": {
                    "type": "integer",
                    "description": "Unique user identifier"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean" },
                    "error": { "type": "string" },
                    "results": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": { "type": "integer" },
                          "name": { "type": "string" },
                          "email": { "type": "string" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

## Using with swagger UI

### Docker

Run Swagger UI pointing to your Hyperterse server:

```bash
docker run -p 8081:8080 \
  -e SWAGGER_JSON_URL=http://host.docker.internal:8080/docs \
  swaggerapi/swagger-ui
```

Open `http://localhost:8081` to browse your API.

### Embedded

You can also embed the OpenAPI spec in your own Swagger UI deployment.

## Type mappings

Hyperterse types map to OpenAPI types:

| Hyperterse | OpenAPI                        |
| ---------- | ------------------------------ |
| `string`   | `string`                       |
| `int`      | `integer` (format: `int64`)    |
| `float`    | `number` (format: `double`)    |
| `boolean`  | `boolean`                      |
| `uuid`     | `string` (format: `uuid`)      |
| `datetime` | `string` (format: `date-time`) |

## API client generation

Use the OpenAPI spec to generate typed API clients:

### JavaScript/TypeScript

```bash
npx openapi-typescript http://localhost:8080/docs --output api.ts
```

### Python

```bash
# Using openapi-python-client
openapi-python-client generate --url http://localhost:8080/docs
```

### Go

```bash
# Using oapi-codegen
oapi-codegen -package api http://localhost:8080/docs > api.go
```

## Response format

All query endpoints return a consistent format:

```json
{
  "success": true,
  "error": "",
  "results": [...]
}
```

This is documented in the OpenAPI spec for all endpoints.

## Error responses

Error responses follow the same structure:

```json
{
  "success": false,
  "error": "validation error for field 'userId': required input is missing",
  "results": []
}
```

<Aside>
  Error messages are sanitized to avoid leaking internal details. Database
  errors are wrapped in generic messages.
</Aside>
